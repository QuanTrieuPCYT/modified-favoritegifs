(function(o,s,a,n,m,p,v){"use strict";function w(e,t){const i=Math.max(...Object.values(e).map(function(r){return r.order}));return{format:t.format,src:t.url,width:t.width,height:t.height,order:i+1}}function y(e){for(let t of e.embeds){if(t.type==="gifv")return{url:t.url,width:t.thumbnail.width,height:t.thumbnail.height,format:2};if(t.type==="image"&&t.url.endsWith(".gif"))return{url:t.url,width:t.image.width,height:t.image.height,format:1}}for(let t of e.attachments)if(t.url.endsWith(".gif"))return{url:t.url,width:t.width,height:t.height,format:1};return null}const{FormRow:F,FormIcon:b}=m.Forms,c=a.findByProps("openLazy","hideActionSheet"),u=a.findByStoreName("UserSettingsProtoStore").frecencyWithoutFetchingLatest,A=s.before("openLazy",c,function(e){const[t,i,r]=e;i==="MessageLongPressActionSheet"&&t.then(function(S){const L=s.after("default",S,function(R,B){n.React.useEffect(function(){return function(){L()}},[]);let[I,f]=B.props?.children?.props?.children?.props?.children;const h=I?.props?.message??r?.message;if(!f||!h)return;const d=y(h);d&&f.unshift(n.React.createElement(F,{label:"Add GIF to Favorites",leading:n.React.createElement(b,{style:{opacity:1},source:p.getAssetIDByName("ic_star_filled")}),onPress:function(){c.hideActionSheet();const l=w(u.favoriteGifs.gifs,d);u.updateAsync("favoriteGifs",function(g){g.gifs[l.src]={...l,order:Math.max(...Object.values(g.gifs).map(function(P){return P.order}))+1}},0),v.showToast("Added GIF to Favorites")}}))})})}),G=function(){return A()};return o.onUnload=G,o})({},vendetta.patcher,vendetta.metro,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.ui.toasts);
