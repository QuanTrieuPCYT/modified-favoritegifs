(function(l,m,n,s,y,a,g){"use strict";function w(o){const e=new URL(o).pathname;return e.substring(e.lastIndexOf("/")+1)}function A(o,e){const t=Math.max(...Object.values(o).map(function(f){return f.order}));return{format:e.format,src:e.src,url:e.url,width:e.width,height:e.height,order:t+1}}function G(o){const e=[];for(let t of o.embeds)t.type==="gifv"?e.push({src:t.video.url,url:t.url,width:t.thumbnail.width,height:t.thumbnail.height,format:2}):t.type==="image"&&t.url.endsWith(".gif")&&e.push({src:t.image.url,url:t.url,width:t.image.width,height:t.image.height,format:1});for(let t of o.attachments)t.url.endsWith(".gif")&&e.push({src:t.url,url:t.url,width:t.width,height:t.height,format:1});return e}const{FormRow:I,FormIcon:R}=y.Forms,v=n.findByProps("openLazy","hideActionSheet"),{addFavoriteGIF:b,removeFavoriteGIF:B}=n.findByProps("addFavoriteGIF","removeFavoriteGIF"),L=n.findByStoreName("UserSettingsProtoStore"),c=L.frecencyWithoutFetchingLatest,S=m.before("openLazy",v,function(o){const[e,t,f]=o;t==="MessageLongPressActionSheet"&&e.then(function(D){const P=m.after("default",D,function(E,U){s.React.useEffect(function(){return function(){P()}},[]);let[$,p]=U.props?.children?.props?.children?.props?.children;const F=$?.props?.message??f?.message;if(!p||!F)return;const h=G(F);if(h.length)for(let r of h){const u=c.favoriteGifs.gifs[r.src]!==void 0||c.favoriteGifs.gifs[r.url]!==void 0,i=w(r.url);let d="";h.length>1?d=u?`Remove ${i} from Favorites`:`Add ${i} to Favorites`:d=u?"Remove from Favorites":"Add to Favorites",p.unshift(s.React.createElement(I,{label:d,leading:s.React.createElement(R,{style:{opacity:1},source:a.getAssetIDByName("ic_star_filled")}),onPress:function(){v.hideActionSheet(),u?(B(r.url),g.showToast(`Removed ${i} from Favorites`,a.getAssetIDByName("ic_checkmark"))):(b(A(c.favoriteGifs.gifs,r)),g.showToast(`Added ${i} to Favorites`,a.getAssetIDByName("ic_checkmark")))}}))}})})}),k=function(){return S()};return l.onUnload=k,l})({},vendetta.patcher,vendetta.metro,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.ui.toasts);
