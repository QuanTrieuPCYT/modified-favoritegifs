(function(s,a,f,n,g,m,p){"use strict";function v(e,t){const i=Math.max(...Object.values(e).map(function(r){return r.order})),o={format:t.format,src:t.url,width:t.width,height:t.height,order:i+1};return{...e,[t.url]:o}}function w(e){for(let t of e.embeds){if(t.type==="gifv")return{url:t.url,width:t.thumbnail.width,height:t.thumbnail.height,format:2};if(t.type==="image"&&t.url.endsWith(".gif"))return{url:t.url,width:t.image.width,height:t.image.height,format:1}}for(let t of e.attachments)if(t.url.endsWith(".gif"))return{url:t.url,width:t.width,height:t.height,format:1};return null}const h=f.findByProps("openLazy","hideActionSheet"),{FormRow:y,FormIcon:F}=g.Forms,u=f.findByStoreName("UserSettingsProtoStore").frecencyWithoutFetchingLatest,b=a.before("openLazy",h,function(e){const[t,i,o]=e;i==="MessageLongPressActionSheet"&&t.then(function(r){const G=a.after("default",r,function(B,S){n.React.useEffect(function(){return function(){G()}},[]);let[I,c]=S.props?.children?.props?.children?.props?.children;const d=I?.props?.message??o?.message;if(!c||!d)return;const l=w(d);l&&c.unshift(n.React.createElement(y,{label:"Add GIF to Favorites",leading:n.React.createElement(F,{style:{opacity:1},source:m.getAssetIDByName("ic_star_filled")}),onPress:function(){h.hideActionSheet();const L=v(u.favoriteGifs.gifs,l);u.favoriteGifs.gifs=L,p.showToast("Added GIF to Favorites")}}))})})}),A=function(){return b()};return s.onUnload=A,s})({},vendetta.patcher,vendetta.metro,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.ui.toasts);
