(function(u,m,s,c,A,r,f,b){"use strict";const B=s.findByProps("openLazy","hideActionSheet"),{addFavoriteGIF:g,removeFavoriteGIF:P}=s.findByProps("addFavoriteGIF","removeFavoriteGIF");function _(i){const t=new URL(i).pathname;return t.substring(t.lastIndexOf("/")+1)}function l(i,t){const e=Math.max(...Object.values(i).map(function(n){return n.order}));return{format:t.format,src:t.src,url:t.url,width:t.width,height:t.height,order:e+1}}function R(i){const t=[];for(let e of i.embeds)e.type==="gifv"?t.push({src:e.video.url,url:e.url,width:e.thumbnail.width,height:e.thumbnail.height,format:2}):e.type==="image"?t.push({src:e.image.url,url:e.url,width:e.image.width,height:e.image.height,format:1}):e.type==="video"&&t.push({src:e.video.url,url:e.url,width:e.thumbnail.width,height:e.thumbnail.height,format:2,isVideo:!0});for(let e of i.attachments)e.content_type&&e.content_type.includes("image")?t.push({src:e.url,url:e.url,width:e.width,height:e.height,format:1}):e.content_type&&e.content_type.includes("video")&&t.push({src:e.url,url:e.url,width:e.width,height:e.height,format:2,isVideo:!0});return t}const D=function(i,t,e,n){return function(){if(B.hideActionSheet(),e)P(i.url),f.showToast(`Removed ${n} from Favorites`,r.getAssetIDByName("check"));else{if(i.isVideo){b.showConfirmationAlert({title:"Add video to Favorites",content:"If a video is the first entry in the GIF picker, on mobile this breaks the picker until a new valid item is added or the video is removed. It will only show on Desktop.",confirmText:"Add to Favorites",cancelText:"Cancel",onConfirm:function(){g(l(t.favoriteGifs.gifs,i)),f.showToast(`Added ${n} to Favorites`,r.getAssetIDByName("check"))}});return}g(l(t.favoriteGifs.gifs,i)),f.showToast(`Added ${n} to Favorites`,r.getAssetIDByName("check"))}}},{FormRow:p,FormIcon:y}=A.Forms,F=s.findByProps("openLazy","hideActionSheet"),S=s.findByStoreName("UserSettingsProtoStore"),{addFavoriteGIF:k,removeFavoriteGIF:N}=s.findByProps("addFavoriteGIF","removeFavoriteGIF"),$=m.before("openLazy",F,function(i){const[t,e,n]=i;e==="MessageLongPressActionSheet"&&t.then(function(O){const T=m.after("default",O,function(j,x){c.React.useEffect(function(){return function(){T()}},[]);let[E,v]=x.props?.children?.props?.children?.props?.children;const w=E?.props?.message??n?.message;if(!v||!w)return;const G=R(w);if(G.length)for(let o of G){const a=S.frecencyWithoutFetchingLatest,I=Math.max(...Object.values(a.favoriteGifs.gifs).map(function(U){return U.order})),h=a.favoriteGifs.gifs[o.src]!==void 0||a.favoriteGifs.gifs[o.url]!==void 0,M=a.favoriteGifs.gifs[o.src]?.order===I||a.favoriteGifs.gifs[o.url]?.order===I,d=_(o.url);v.unshift(c.React.createElement(p,{label:h?`Remove ${d} from Favorites`:`Add ${d} to Favorites`,leading:c.React.createElement(y,{style:{opacity:1},source:h?r.getAssetIDByName("ic_clear"):r.getAssetIDByName("ic_star_filled")}),onPress:D(o,a,h,d)})),h&&!M&&v.unshift(c.React.createElement(p,{label:`Bump ${d} to the top of Favorites`,leading:c.React.createElement(y,{style:{opacity:1},source:r.getAssetIDByName("ic_activity_24px")}),onPress:function(){F.hideActionSheet(),N(o.url),k(l(a.favoriteGifs.gifs,o)),f.showToast(`Bumped ${d} to the top of Favorites`,r.getAssetIDByName("check"))}}))}})})});var L={onUnload:function(){return $()}};return u.default=L,Object.defineProperty(u,"__esModule",{value:!0}),u})({},vendetta.patcher,vendetta.metro,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.ui.toasts,vendetta.ui.alerts);
