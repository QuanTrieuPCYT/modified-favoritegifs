(function(a,f,o,i,g,v,u){"use strict";function p(e,t){const n=Math.max(...Object.values(e).map(function(s){return s.order}));return{format:t.format,src:t.url,width:t.width,height:t.height,order:n+1}}function F(e){for(let t of e.embeds){if(t.type==="gifv")return{url:t.url,width:t.thumbnail.width,height:t.thumbnail.height,format:2};if(t.type==="image"&&t.url.endsWith(".gif"))return{url:t.url,width:t.image.width,height:t.image.height,format:1}}for(let t of e.attachments)if(t.url.endsWith(".gif"))return{url:t.url,width:t.width,height:t.height,format:1};return null}const{FormRow:w,FormIcon:y}=g.Forms,c=o.findByProps("openLazy","hideActionSheet"),{addFavoriteGIF:G,removeFavoriteGIF:b}=o.findByProps("addFavoriteGIF","removeFavoriteGIF"),h=o.findByStoreName("UserSettingsProtoStore").frecencyWithoutFetchingLatest,R=f.before("openLazy",c,function(e){const[t,n,s]=e;n==="MessageLongPressActionSheet"&&t.then(function(I){const P=f.after("default",I,function(L,S){i.React.useEffect(function(){return function(){P()}},[]);let[B,d]=S.props?.children?.props?.children?.props?.children;const l=B?.props?.message??s?.message;if(!d||!l)return;const r=F(l);if(!r)return;const m=h.favoriteGifs.gifs[r.url]!==void 0;d.unshift(i.React.createElement(w,{label:m?"Remove from Favorites":"Add to Favorites",leading:i.React.createElement(y,{style:{opacity:1},source:v.getAssetIDByName("ic_star_filled")}),onPress:function(){c.hideActionSheet(),m?(b(r.url),u.showToast("Removed from Favorites")):(G(p(h.favoriteGifs.gifs,r)),u.showToast("Added to Favorites"))}}))})})}),A=function(){return R()};return a.onUnload=A,a})({},vendetta.patcher,vendetta.metro,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.ui.toasts);
