(function(a,c,u,n,p,v,i,y){"use strict";function w(e,t){const r=Math.max(...Object.values(e).map(function(f){return f.order}));return{format:t.format,src:t.url,width:t.width,height:t.height,order:r+1}}function G(e){for(let t of e.embeds){if(t.type==="gifv")return{url:t.url,width:t.thumbnail.width,height:t.thumbnail.height,format:2};if(t.type==="image"&&t.url.endsWith(".gif"))return{url:t.url,width:t.image.width,height:t.image.height,format:1}}for(let t of e.attachments)if(t.url.endsWith(".gif"))return{url:t.url,width:t.width,height:t.height,format:1};return null}function s(e){const t=Object.getOwnPropertyNames(e.__proto__).concat(Object.getOwnPropertyNames(Object.getPrototypeOf(e))).filter(function(r){return typeof e[r]=="function"});i.logger.log(t)}const{FormRow:b,FormIcon:F}=p.Forms,h=u.findByProps("openLazy","hideActionSheet"),o=u.findByStoreName("UserSettingsProtoStore").frecencyWithoutFetchingLatest,O=c.before("openLazy",h,function(e){const[t,r,f]=e;r==="MessageLongPressActionSheet"&&t.then(function(S){const A=c.after("default",S,function(I,j){n.React.useEffect(function(){return function(){A()}},[]);let[B,g]=j.props?.children?.props?.children?.props?.children;const l=B?.props?.message??f?.message;if(!g||!l)return;const d=G(l);d&&g.unshift(n.React.createElement(b,{label:"Add GIF to Favorites",leading:n.React.createElement(F,{style:{opacity:1},source:v.getAssetIDByName("ic_star_filled")}),onPress:function(){h.hideActionSheet(),i.logger.log("Store methods:",s(o)),i.logger.log("FavGif methods:",s(o.favoriteGifs)),i.logger.log("Gif methods:",s(o.favoriteGifs.gifs));const m=w(o.favoriteGifs.gifs,d);o.favoriteGifs.gifs[m.src]=m,o.favoriteGifs={...o.favoriteGifs},y.showToast("Added GIF to Favorites")}}))})})}),P=function(){return O()};return a.onUnload=P,a})({},vendetta.patcher,vendetta.metro,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta,vendetta.ui.toasts);
